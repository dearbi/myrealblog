<!DOCTYPE html><html lang="[&quot;zh-CN&quot;,&quot;en&quot;,&quot;default&quot;]" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>World Quant ⭐ How BRAIN works | 毕文博的博客</title><meta name="author" content="毕文博"><meta name="copyright" content="毕文博"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="下面的文章详细阐述了BRAIN平台是如何工作的，以及在您进行alpha回测时后台发生了什么。尽管您永远不需要自己进行这些计算，但了解它们将有助于您制定alpha策略。想象市场数据是一个矩阵，每行代表一个日期，每列代表一只股票。例如，美国TOP3000股票池中股票的收盘价数据矩阵如下所示  当您..."><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "World Quant ⭐ How BRAIN works",
  "url": "https://dearbi.github.io/myrealblog/2025/08/27/World-Quant-%E2%AD%90-How-BRAIN-works/",
  "image": "https://dearbi.github.io/myrealblog/img/showpage.jpg",
  "datePublished": "2025-08-27T08:39:04.000Z",
  "dateModified": "2025-09-04T05:21:30.798Z",
  "author": [
    {
      "@type": "Person",
      "name": "毕文博",
      "url": "https://dearbi.github.io/myrealblog"
    }
  ]
}</script><link rel="shortcut icon" href="/myrealblog/img/favicon.ico"><link rel="canonical" href="https://dearbi.github.io/myrealblog/2025/08/27/World-Quant-%E2%AD%90-How-BRAIN-works/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/myrealblog/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/myrealblog/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'World Quant ⭐ How BRAIN works',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><style>
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}
::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 3px;
}
::-webkit-scrollbar-thumb {
  background: #49b1f5;
  border-radius: 3px;
}
::-webkit-scrollbar-thumb:hover {
  background: #ff7242;
}
.recent-post-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
  transition: all 0.2s ease;
}
.card-widget:hover {
  transform: translateY(-1px);
  transition: transform 0.2s ease;
}
/* 访问控制管理按钮样式 */
.auth-control-btn {
  position: fixed;
  bottom: 80px;
  right: 20px;
  background: linear-gradient(135deg, #667eea, #764ba2);
  color: white;
  border: none;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  cursor: pointer;
  font-size: 18px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  transition: all 0.3s ease;
  z-index: 999;
  display: flex;
  align-items: center;
  justify-content: center;
}
.auth-control-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
}
.auth-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  z-index: 9999;
  align-items: center;
  justify-content: center;
}
.auth-modal.show {
  display: flex;
}
.auth-modal-content {
  background: white;
  padding: 30px;
  border-radius: 15px;
  max-width: 400px;
  width: 90%;
  text-align: center;
  box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
}
</style>
<meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/myrealblog/img/background.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/myrealblog/img/showpage.jpg" onerror="this.onerror=null;this.src='/myrealblog/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/myrealblog/archives/"><div class="headline">文章</div><div class="length-num">8</div></a><a href="/myrealblog/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/myrealblog/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/myrealblog/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/myrealblog/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/myrealblog/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/myrealblog/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/myrealblog/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/myrealblog/img/background.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/myrealblog/"><span class="site-name">毕文博的博客</span></a><a class="nav-page-title" href="/myrealblog/"><span class="site-name">World Quant ⭐ How BRAIN works</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/myrealblog/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/myrealblog/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/myrealblog/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/myrealblog/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/myrealblog/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">World Quant ⭐ How BRAIN works</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-08-27T08:39:04.000Z" title="发表于 2025-08-27 16:39:04">2025-08-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-04T05:21:30.798Z" title="更新于 2025-09-04 13:21:30">2025-09-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/myrealblog/categories/World-Quant/">World Quant</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id><a href="#" class="headerlink" title></a></h2><p>下面的文章详细阐述了BRAIN平台是如何工作的，以及在您进行alpha回测时后台发生了什么。尽管您永远不需要自己进行这些计算，但了解它们将有助于您制定alpha策略。<br>想象市场数据是一个矩阵，每行代表一个日期，每列代表一只股票。例如，美国TOP3000<a target="_blank" rel="noopener external nofollow noreferrer" href="https://support.worldquantbrain.com/hc/en-us/articles/4902349883927-Click-here-for-a-list-of-terms-and-their-definitions#:~:text=U-,Universe,-Universe">股票池</a>中股票的收盘价数据矩阵如下所示</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tcnvzc64vul9.feishu.cn/space/api/box/stream/download/asynccode/?code=NzMyYzcyNTBiNjA4OWMzNjQyMzI5MDA5NmIxZDYzZjlfMVJVSURScmNVaUNMcEl3WUx0d3RyUmFvR0xKUU1nQllfVG9rZW46TU1ma2JqQnU1b05HbDF4MDlKbWNETEVrbkxmXzE3NTY5NjMyODM6MTc1Njk2Njg4M19WNA"></p>
<p>当您输入回测设置并点击“回测”时，BRAIN平台将针对每个日期的市场数据矩阵评估Alpha表达式，对每个金融工具进行多头或空头操作，以生成PnL图表.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tcnvzc64vul9.feishu.cn/space/api/box/stream/download/asynccode/?code=ZjU1ZTBjY2QwZjA3NTE3YWFhMjM2MjI2ZTI2OWYxMmFfcUtNbVEzQlJ5SFFBQk5KV0E3Y3J5MnJwaVZldU5SV2hfVG9rZW46T2UzUmJEMEJzb0VwQUh4VlU5MWN0TXM3bkhnXzE3NTY5NjMyODM6MTc1Njk2Njg4M19WNA"></p>
<p>在幕后，生成最终PnL图表之前需要执行七个步骤或操作。</p>
<p>通常，在alpha回测中，股票池中会有200到3000种股票工具。但为了更好地理解这个概念，我们假设回测股票池中只有八只股票。我们现在回测表达式rank(-returns)，并使用市场中性化、延迟1和衰减0设置。</p>
<p>这个表达式的假设是，我们想在明天买入或做多今天收益率为负或相对较低的股票，同时卖出或做空今天收益率为正或相对较高的股票。</p>
<p>我们使用了排名运算符，它对运算符内的输入值进行排序，并返回在0和1之间均匀分布的值。这是一个回归思路的例子.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tcnvzc64vul9.feishu.cn/space/api/box/stream/download/asynccode/?code=ODBiNGNmM2EyMDFjOTc5ZDczOWI2NjM4MDU2ODVlYTNfS2NSbGNsTGJTZnRYME9jMHlDWDJmNDVLUXdtRVVCdVdfVG9rZW46QjdQWWJUVktIb3JWM3p4TmNyQ2NEVjBRbkhkXzE3NTY5NjMyODM6MTc1Njk2Njg4M19WNA"></p>
<p>在列B中，我们有alpha向量中的八只股票。列C显示了截至2月1日的这些股票的收益率。这些数据作为alpha表达式的输入数据.</p>
<p><strong>步骤1:</strong> 为每只股票评估表达式，以生成给定日期的alpha向量。<br>在我们的例子中，这个日期是2月2日，因为我们假设了延迟1设置。延迟1设置使用T-1日期的数据创建T日期的alpha向量。<br>为了生成alpha向量，回测器对负收益率执行排名操作，并为每只股票生成一个对应的值向量.</p>
<p>生成的向量取决于在alpha表达式中使用的运算符。在我们的例子中，由于我们使用了排名运算符，所以在列D中可以看到在0和1之间均匀分布的值。请注意，收益率最低的股票具有最高的值，反之亦然，这符合我们的假设.</p>
<p><em><strong>步骤2</strong>:</em> 从向量中的每个值中减去该组向量值的平均值。所有向量值的总和&#x3D;0。这称为中性化。</p>
<p>该组可以是整个市场，但我们也可以在股票的部门、行业或子行业分组上执行这个中性化操作.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tcnvzc64vul9.feishu.cn/space/api/box/stream/download/asynccode/?code=NzEzNGE1ZjE2MDg2Y2IwNjczNmMwY2NlOTE4YjA0MDhfbnZmZjJrUkZLazNOQkRUajBja1VMd0lmVzlkdmpsb2FfVG9rZW46R0F6eGJtd0dHb1E0b1h4VmNVbWNxaHBtbnJmXzE3NTY5NjMyODM6MTc1Njk2Njg4M19WNA"></p>
<p>由于我们的回测股票池中只有八只股票，我们假设在市场上对股票进行中性化。</p>
<p>所以我们取单元格D12中的数字的平均值，并从每只股票中减去平均值。这给我们在列F中生成了一个新的向量。注意，这些新数字的总和和平均值现在都是零。同时，正值之和等于负值之和.</p>
<p><em><strong>步骤3:</strong></em> <em>将生成的值缩放或”标准化”，使得alpha向量值的绝对值总和为1。这些值可以称为标准化权重.</em></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tcnvzc64vul9.feishu.cn/space/api/box/stream/download/asynccode/?code=NDFiYWUyZGU2Y2RkNDdlZGNkODVmZDBkMWM5ZjViYTRfb2hrSjY1U2hxUGRmNGc2dFNQT3F6czE0ZkRyNkV6WXVfVG9rZW46UTE1cGJqTUhObzlHb054dlVONWN4R1Qzbm5kXzE3NTY5NjMyODM6MTc1Njk2Njg4M19WNA"></p>
<p>也就是说，我们对每行绝对值加和，即2.3。然后我们将每行的值除以这个和，得到在G列中的归一化权重。这些权重的绝对值之和现在等于1.</p>
<p>注意：在每个迭代&#x2F;日，表达式rank(-returns)将获得到该日为止的所有收益数据，矩阵将每天增加一行，直到达到最近的日期。表达式的作用是将输入矩阵转换为输出的权重向量，正如我们在这个假设的例子中看到的那样.</p>
<p><em><strong>步骤4:</strong></em> <em>使用归一化权重，BRAIN回测器将资金（从回测盘的2000万美元账户）分配给每个股票以构建投资组合.</em></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tcnvzc64vul9.feishu.cn/space/api/box/stream/download/asynccode/?code=N2NmOTMxMjQ4YzJkMzY1OTcwYmM3MDlhYjVkMTQwODhfS2owOG83OUcyUkNRZzRKM282SDladUlsMlI5QzFkUG1fVG9rZW46WnJRN2JQazNWb0R0QlB4M1VGRWNkNGQwblRoXzE3NTY5NjMyODM6MTc1Njk2Njg4M19WNA"></p>
<p>J列中有总共2000万虚拟资金分配给股票，使用H列中的归一化权重。这意味着我们对股票1的头寸为负440万美元，也就是说，我们做了440万美元的股票1做空交易，对股票5的头寸为正60万美元，也就是说，我们投资了60万美元的股票5。</p>
<p>这被称为多空市场中性化，这是创建这些预测模型或alpha的支柱。使用这种技术，策略可以在市场走势方向不确定的情况下实现盈利.</p>
<p><em><strong>步骤5:</strong></em> <em>根据当天观察到的股票回报率计算alpha生成的下一天的收益</em></p>
<p>也就是说，在分配了股票的美元头寸后，我们根据每只股票当天的回报率计算每只股票的收益.</p>
<p>假设这些股票截至2月2日的实际回报率如K列所示。我们可以看到，尽管我们预计股票1和股票2的价格会下跌，但它们实际上上涨了，所以我们亏损了，显示在L列中。</p>
<p>我们预计股票6的价格会上涨，但它没有变化。因此，我们对三只股票的预测是错误的，但对五只股票的预测是正确的。在这一天中，我们使用我们的alpha赚了0.03万美元的收益，通过将我们向量中所有股票的PnL相加计算得出。这就是回测器计算任何给定日期alpha生成的PnL的方法</p>
<p><em><strong>步骤6:</strong></em> <em>对于历史时间跨度（也称为样本内期间（IS)）中的每个日期重复执行第1步到第5步的操作，以获取每天生成的日收益</em></p>
<p>对于每一天，表达式都会被评估，Alpha输出向量中的值表示要分配给每个股票的权重。Alpha权重并不是您想要购买或出售的金额，而是您在这一天所达到的加权仓位。这些权重乘以账户规模（投资组合中投入的总资金）以获取每只股票持有的美元价值。例如，如果MSFT的Alpha权重（经过中性化<a target="_blank" rel="noopener external nofollow noreferrer" href="https://support.worldquantbrain.com/hc/en-us/articles/4902349883927-Click-here-for-a-list-of-terms-and-their-definitions#:~:text=strategy.-,Neutralization,-Neutralization">neutralization</a>和缩放后）为0.2423，则我们将拥有总价值为0.2423 *账户规模的MSFT股票。</p>
<p>权重（<a target="_blank" rel="noopener external nofollow noreferrer" href="https://support.worldquantbrain.com/hc/en-us/articles/4902349883927-Click-here-for-a-list-of-terms-and-their-definitions#:~:text=W-,Weight,-BRAIN">weight</a>）可以为负数，意味着您会对这些股票做空交易。如果权重为正数，则表示您将对这些股票做多头交易，即购买这些股票。<a target="_blank" rel="noopener external nofollow noreferrer" href="https://support.worldquantbrain.com/hc/en-us/articles/4902349883927-Click-here-for-a-list-of-terms-and-their-definitions#:~:text=N-,NaN,-NaN">NAN</a>值表示不分配权重给该合约（即不分配资金）。您在特定日期购买&#x2F;出售的股票价值由今天的权重和昨天的权重之差决定。当天交易的投资组合的百分比（按美元价值计算）称为“换手率”。<a target="_blank" rel="noopener external nofollow noreferrer" href="https://support.worldquantbrain.com/hc/en-us/articles/4902349883927-Click-here-for-a-list-of-terms-and-their-definitions#:~:text=definition.-,Simulation,-Simulation">回测结果</a>中报告的换手率是回测期间的平均日<a target="_blank" rel="noopener external nofollow noreferrer" href="https://support.worldquantbrain.com/hc/en-us/articles/4902349883927-Click-here-for-a-list-of-terms-and-their-definitions#:~:text=details.-,Turnover,-Average">换手率</a></p>
<p><em><strong>步骤7:</strong></em> <em>计算从样本内期间开始到现在（本例中是五年）的alpha累积PnL，以获取alpha的PnL图表.</em></p>
<p>根据这些每天的头寸，计算和显示<a target="_blank" rel="noopener external nofollow noreferrer" href="https://support.worldquantbrain.com/hc/en-us/articles/4902349883927-Click-here-for-a-list-of-terms-and-their-definitions#:~:text=consultants-,Profit%20and%20Loss%20(PnL),-Profit">PnL</a>。默认情况下，BRAIN平台会将您的权重进行归一化（根据输入的操作），并创建价值2000万美元（总账户规模<a target="_blank" rel="noopener external nofollow noreferrer" href="https://support.worldquantbrain.com/hc/en-us/articles/4902349883927-Click-here-for-a-list-of-terms-and-their-definitions#:~:text=details.-,Booksize,-Booksize">booksize</a>）的股权组合。（请注意，投资组合只是一组证券。)</p>
<p>可以通过alpha的PnL图表更好地理解这一点，如我们的示例中的rank(-returns)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tcnvzc64vul9.feishu.cn/space/api/box/stream/download/asynccode/?code=MjA0ZTUxMGVkYTI5ZjUwMjFiNGNmNDZlYTU3ZmY2OGVfMjNxdGZpNWFYNmMzTXY4QUlqNGRXWHR1Sm1pNXU4TWRfVG9rZW46V0JjOGJDYVhDb2FtM3F4U0xjQ2N4QmdUblNlXzE3NTY5NjMyODM6MTc1Njk2Njg4M19WNA"></p>
<p>在这张图表中，我们有一个为期五年的IS期，从2016年2月到2021年1月。使用我们讨论的步骤，回测器将计算alpha的每日PnL，并推导出累积PnL图表，如我们在此处看到的。请注意，在2021年2月到2023年1月的两年中，我们看不到回测窗口的内容。这被称为样本外期（OS）。提交alpha后，将运行几个测试以分析alpha在OS期间的表现。通过样本内和样本外测试均通过的alpha可以称为强健的alpha。</p>
<p>这就是BRAIN回测器如何从alpha创建PnL图表的方式。</p>
<p>在我们的示例中，我们假设我们使用市场中性化和Decay 0设置。但是，如果使用任何其他中性化设置，则会对alpha执行相同的操作。</p>
<p>假设我们的回测股票池中有80只股票，其中有10个行业，每个行业有8只股票。回测器将对每个组执行相同的操作（首先执行步骤1到步骤5），最后将每个组的PnL相加以获得alpha的每日PnL，并创建累积PnL图表（步骤6和步骤7）。</p>
<p>但是，如果我们在alpha设置中引入衰减，必须执行其他步骤才能获得最终的alpha向量。</p>
<p>假设我们在回测设置中使用衰减3。则通过将今天的值与前一天的衰减值相结合来计算alpha中的最终权重向量。在我们的示例中，我们计算了2月2日的alpha中的归一化权重。让我们假设2月1日和1月31日的alpha向量中的归一化权重如N列和O列所示.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tcnvzc64vul9.feishu.cn/space/api/box/stream/download/asynccode/?code=MWQzNjYzYTliZTJkY2M4MTVlYzIwM2IzNmNhNTVkMzRfR2hPdkgwR21TSWk2ckZnZGFCcVg5VkFpRmlRZmdETzZfVG9rZW46QVVYeWJGYk1Ib3FSM1B4c2JheWNFR0IwbmlnXzE3NTY5NjMyODM6MTc1Njk2Njg4M19WNA"></p>
<p>则使用以下加权平均公式计算alpha中的最终权重:</p>
<p>Decay_linear(x,n)&#x3D;x[date]∗n+x[date−1]∗(n−1)+…+x[date−n−1]n+(n−1)+…+1</p>
<p>该公式实现在P列中。使用这个新的派生向量，回测器将计算每日PnL，从而获得累积PnL图表。请注意，即使使用衰减，也会将更多的权重分配给最近的值。因此，衰减是减少交易成本或换手率的非常重要的因素，因为它包括前几天的信息，防止alpha过于反应灵敏。</p>
<p>总之，我们在BRAIN回测器中输入了alpha表达式和回测设置之后，它将执行上述操作，以为每个金融工具建立多头或空头头寸，并生成PnL图表。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://dearbi.github.io/myrealblog">毕文博</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://dearbi.github.io/myrealblog/2025/08/27/World-Quant-%E2%AD%90-How-BRAIN-works/">https://dearbi.github.io/myrealblog/2025/08/27/World-Quant-%E2%AD%90-How-BRAIN-works/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://dearbi.github.io/myrealblog" target="_blank">毕文博的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/myrealblog/tags/World-Quant/">World Quant</a><a class="post-meta__tags" href="/myrealblog/tags/BRAIN/">BRAIN</a></div><div class="post-share"><div class="social-share" data-image="/myrealblog/img/showpage.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/myrealblog/2025/09/02/hello-world/" title="Hello World"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Hello World</div></div><div class="info-2"><div class="info-item-1">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;  More info: Writing Run server1$ hexo server  More info: Server Generate static files1$ hexo generate  More info: Generating Deploy to remote sites1$ hexo deploy  More info: Deployment </div></div></div></a><a class="pagination-related" href="/myrealblog/2025/08/03/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/" title="中外课程学习指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">中外课程学习指南</div></div><div class="info-2"><div class="info-item-1">计科中外学习指南中外第三学期课程指南（大二上） 操作系统 ：为考研 408 课程，请自己考虑是不是要好好学一下。 离散数学 ：为计算机科学基础，难度较大，建议上课好好听，做好笔记、好好复习。 面向对象开发 ：授课语言为 Java，难度较大，之前高级程序设计没学明白的建议提前花时间复习一下；核心是面向对象的思想。  参考资料 操作系统 ：Operating Systems: Three Easy Pieces ，对应中文版见群文件 计算机系统 ：《深入理解计算机系统 - CSAPP》，建议像在计算机领域发展的同学阅读一下，见群文件 离散数学 ：《离散数学》左孝凌著，见群文件，同时该书为下学期教材 离散数学浓缩版 ：我的博客 ，内容不全，可能有错误，但是浓缩，欢迎勘误 面向对象开发 ：核心思想可以阅读《大话设计模式》自行体会（该书示例代码不是 Java），见群文件 面向对象开发 ：《Java 编程思想》，见群文件  中外第四学期课程指南（大二下） 数据结构 ：为考研 408 课程，请自己考虑是不是要好好学一下。 计算机网络 ：为考研 408 课程，请自己考虑是不是要好好学一下。 智能...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/myrealblog/2025/09/07/Read-this-First-Starter-Pack/" title="Read this First - Starter Pack"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-07</div><div class="info-item-2">Read this First - Starter Pack</div></div><div class="info-2"><div class="info-item-1">Table of Contents 研究顾问  金融基础知识  量化分析  如何使用BRAIN平台  股市分析方法   欢迎来到WorldQuant BRAIN 本指南的目的是提供BRAIN顾问项目的基本概述和简单的量化金融概念，以帮助您开始创建Alpha。在完成本指南的学习后，你将获得足够的知识来尝试回测你的策略。这是一个学习的过程，许多人以前有同样的经历，所以无论你的背景如何，你也可以做到。祝您好运! 本课程有以下章节供您学习 研究顾问—与WorldQuant一起合作的机会 金融基础知识–股票市场和它的运作模式 量化分析–及其与BRAIN平台的关系 如何使用BRAIN平台–快速表达式、操作符和数据集 常见的金融分析方法及实例–技术和基本面分析 研究顾问 成为我们的顾问 WorldQuant是一家全球量化资产管理公司。由Igor Tulchinsky创立于2007年，我们的团队在全球拥有超过850名员工，在全球市场上开发和部署各种资产类别的投资策略。我们为全球人才提供机会，让他们在我们项目开展的国家成为研究顾问，并参与到WorldQuant的研究工作中。 全球社区 通过我们专有...</div></div></div></a><a class="pagination-related" href="/myrealblog/2025/09/07/WorldQuant-Brain-%E5%88%9D%E7%BA%A7%E9%98%B6%E6%AE%B5%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/" title="WorldQuant Brain 初级阶段学习路线"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-07</div><div class="info-item-2">WorldQuant Brain 初级阶段学习路线</div></div><div class="info-2"><div class="info-item-1">初级指引 什么是Alphas? &#x2F; Introduction to Alphas | WorldQuant BRAIN：&#x20;  Brain平台的原理 &#x2F;⭐ How BRAIN platform works | WorldQuant BRAIN： &#x20;  Brain快速表达式 &#x2F; Introduction to BRAIN Expression Language | WorldQuant BRAIN&#x20;   运算符 &#x2F; Operators &amp; 数据集 &#x2F;Datasets&#x20;  理解数据结构和基本概念&#x2F;Understanding Data in BRAIN: Key Concepts and Tips | WorldQuant BRAIN  如何使用数据浏览器&#x2F;How to use the Data Explorer | WorldQuant BRAIN  运算符 &#x2F; Operators| WorldQuant BRAIN  三维数据类型&#x2F;Vector D...</div></div></div></a><a class="pagination-related" href="/myrealblog/2025/09/07/%E5%88%B0%E5%BA%95%E8%A6%81%E4%BA%A4%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84Alpha%EF%BC%9F/" title="到底要交什么样的Alpha？"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-07</div><div class="info-item-2">到底要交什么样的Alpha？</div></div><div class="info-2"><div class="info-item-1"> 到底要交什么样的Alpha？在Alpha开发与提交的过程中，许多新人常常会问：“到底什么样的Alpha才值得提交？”这是一个复杂的问题，因为Alpha的质量并没有一个单一的“金标准”可以作为绝对的判断依据。新人常见的错误是过度依赖某一两个单一指标，比如 Sharpe、Fitness 或 Margin，认为只要这些指标表现良好，Alpha就一定值得提交。 然而，判断一个Alpha是否值得提交更像是诊断病情——不能仅仅依靠一个指标或单一的维度来做出决定。单一指标可能会提供片面的信息，而忽略了Alpha整体表现的复杂性和多样性。这种过度依赖单一指标的思维方式，往往会导致新人在Alpha提交过程中出现偏差。  数量与质量的平衡：螺旋上升的原则在Alpha的开发与提交过程中，数量和质量是两个不可分割的重要维度。许多新人在实践中常常犯两个极端的错误：要么过度关注质量而忽视数量，要么完全不管质量，只追求数量。这两种错误都会对Alpha的整体表现产生负面影响。 数量不足的问题如果过度追求质量而导致提交的Alpha数量不足，可能会出现以下问题：  Portfolio不稳定：Alpha的数量不足会...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/myrealblog/img/showpage.jpg" onerror="this.onerror=null;this.src='/myrealblog/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">毕文博</div><div class="author-info-description">欢迎来到我的博客</div><div class="site-data"><a href="/myrealblog/archives/"><div class="headline">文章</div><div class="length-num">8</div></a><a href="/myrealblog/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/myrealblog/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/dearbi"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/dearbi" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:2199463351@qq.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://blog.csdn.net/dear_bi_MyOnly?spm=1000.2115.3001.5343" rel="external nofollow noreferrer" target="_blank" title="CSDN"><i class="fas fa-blog"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text"></span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/myrealblog/2025/09/13/%E6%9D%82%E5%BF%B5/" title="杂念">杂念</a><time datetime="2025-09-13T11:05:08.000Z" title="发表于 2025-09-13 19:05:08">2025-09-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/myrealblog/2025/09/07/WorldQuant-Brain-%E5%88%9D%E7%BA%A7%E9%98%B6%E6%AE%B5%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/" title="WorldQuant Brain 初级阶段学习路线">WorldQuant Brain 初级阶段学习路线</a><time datetime="2025-09-07T12:25:41.000Z" title="发表于 2025-09-07 20:25:41">2025-09-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/myrealblog/2025/09/07/%E5%88%B0%E5%BA%95%E8%A6%81%E4%BA%A4%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84Alpha%EF%BC%9F/" title="到底要交什么样的Alpha？">到底要交什么样的Alpha？</a><time datetime="2025-09-07T05:16:42.000Z" title="发表于 2025-09-07 13:16:42">2025-09-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/myrealblog/2025/09/07/Read-this-First-Starter-Pack/" title="Read this First - Starter Pack">Read this First - Starter Pack</a><time datetime="2025-09-07T02:12:24.000Z" title="发表于 2025-09-07 10:12:24">2025-09-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/myrealblog/2025/09/04/%E5%A4%A7%E4%BA%8C%E5%BC%80%E5%AD%A6%E5%88%9D%E6%9C%9F/" title="大二开学初期">大二开学初期</a><time datetime="2025-09-04T05:02:42.000Z" title="发表于 2025-09-04 13:02:42">2025-09-04</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By 毕文博</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/myrealblog/js/utils.js"></script><script src="/myrealblog/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"></div><script>
// 访问控制脚本
(function() {
  const ACCESS_CODE = 'bwb';
  const ADMIN_CODE = 'admin2025';
  
  // 防止重复加载
  if (window.authPageLoaded) return;
  window.authPageLoaded = true;
  
  // 获取主页路径
  function getHomePath() {
    const hostname = window.location.hostname;
    const pathname = window.location.pathname;
    
    if (hostname === 'localhost' || hostname === '127.0.0.1') {
      return '/myrealblog/';
    }
    
    if (hostname.includes('github.io')) {
      return '/myrealblog/';
    }
    
    return '/';
  }
  
  // 获取验证页面路径
  function getAuthPath() {
    const homePath = getHomePath();
    return homePath + 'auth.html';
  }
  
  // 检查验证状态（仅检查当前会话，不使用持久化存储）
  function checkAuthStatus() {
    // 检查当前会话是否已验证
    return sessionStorage.getItem('current_session_verified') === 'true';
  }
  
  // 设置当前会话验证状态
  function setSessionVerified() {
    sessionStorage.setItem('current_session_verified', 'true');
  }
  
  // 检查是否启用访问控制
  function isAuthEnabled() {
    const authSettings = localStorage.getItem('blog_auth_settings');
    if (authSettings) {
      try {
        const settings = JSON.parse(authSettings);
        return settings.enabled !== false;
      } catch (e) {
        return true;
      }
    }
    return true;
  }
  
  // 创建管理界面
  function createAuthManagement() {
    const button = document.createElement('button');
    button.className = 'auth-control-btn';
    button.innerHTML = '🔐';
    button.title = '访问控制管理';
    
    button.onclick = function() {
      showAuthModal();
    };
    
    document.body.appendChild(button);
    
    // 创建模态框
    const modal = document.createElement('div');
    modal.className = 'auth-modal';
    modal.innerHTML = `
      <div class="auth-modal-content">
        <h3>访问控制管理</h3>
        <p>当前状态: <span id="authStatus"></span></p>
        <p style="font-size: 14px; color: #666; margin: 10px 0;">注意：现在每次访问都需要验证，不会记住验证状态</p>
        <div style="margin: 20px 0;">
          <button id="toggleAuth" class="btn" style="margin: 5px; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">切换状态</button>
        </div>
        <div style="margin: 15px 0;">
          <input type="password" id="adminPassword" placeholder="请输入管理密码" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
        </div>
        <button id="confirmAction" class="btn" style="background: #667eea; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">确认操作</button>
        <button onclick="closeAuthModal()" style="background: #ccc; color: black; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">取消</button>
      </div>
    `;
    
    document.body.appendChild(modal);
    
    // 绑定事件
    modal.onclick = function(e) {
      if (e.target === modal) closeAuthModal();
    };
  }
  
  // 显示管理界面
  function showAuthModal() {
    const modal = document.querySelector('.auth-modal');
    const status = document.getElementById('authStatus');
    const toggleBtn = document.getElementById('toggleAuth');
    
    const enabled = isAuthEnabled();
    status.textContent = enabled ? '已启用' : '已禁用';
    status.style.color = enabled ? '#e74c3c' : '#27ae60';
    toggleBtn.textContent = enabled ? '禁用访问控制' : '启用访问控制';
    
    modal.classList.add('show');
  }
  
  // 关闭管理界面
  window.closeAuthModal = function() {
    document.querySelector('.auth-modal').classList.remove('show');
  };
  
  // 确认操作
  document.addEventListener('click', function(e) {
    if (e.target && e.target.id === 'confirmAction') {
      const password = document.getElementById('adminPassword').value;
      if (password !== ADMIN_CODE) {
        alert('管理密码错误！');
        return;
      }
      
      const toggleBtn = document.getElementById('toggleAuth');
      if (toggleBtn.textContent.includes('禁用')) {
        // 禁用访问控制
        localStorage.setItem('blog_auth_settings', JSON.stringify({enabled: false}));
        alert('访问控制已禁用');
      } else {
        // 启用访问控制
        localStorage.setItem('blog_auth_settings', JSON.stringify({enabled: true}));
        alert('访问控制已启用');
      }
      
      closeAuthModal();
    }
  });
  
  // 主入口检查
  function performAuthCheck() {
    // 如果在验证页面，不做检查
    if (window.location.pathname.includes('auth.html')) {
      return;
    }
    
    // 检查是否启用访问控制
    if (!isAuthEnabled()) {
      return;
    }
    
    // 检查验证状态
    if (!checkAuthStatus()) {
      // 延迟跳转避免立即跳转问题
      setTimeout(() => {
        window.location.href = getAuthPath();
      }, 100);
    }
  }
  
  // 页面加载完成后执行检查
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
      performAuthCheck();
      createAuthManagement();
    });
  } else {
    performAuthCheck();
    createAuthManagement();
  }
})();
</script>
<script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>